
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>scattertext &#8212; Scattertext 0.0.2.9 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for scattertext</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">scattertext.frequencyreaders.DefaultBackgroundFrequencies</span> <span class="k">import</span> <span class="n">DefaultBackgroundFrequencies</span>

<span class="n">version</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">version</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scattertext.viz</span>

<span class="kn">from</span> <span class="nn">scattertext.characteristic.DenseRankCharacteristicness</span> <span class="k">import</span> <span class="n">DenseRankCharacteristicness</span>
<span class="kn">from</span> <span class="nn">scattertext.CorpusDF</span> <span class="k">import</span> <span class="n">CorpusDF</span>
<span class="kn">from</span> <span class="nn">scattertext.CorpusFromFeatureDict</span> <span class="k">import</span> <span class="n">CorpusFromFeatureDict</span>
<span class="kn">from</span> <span class="nn">scattertext.TermCategoryFrequencies</span> <span class="k">import</span> <span class="n">TermCategoryFrequencies</span>
<span class="kn">from</span> <span class="nn">scattertext.diachronic</span> <span class="k">import</span> <span class="n">GanttChart</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromTopicModel</span> <span class="k">import</span> <span class="n">FeatsFromTopicModel</span>
<span class="kn">from</span> <span class="nn">scattertext.termscoring.BM25Difference</span> <span class="k">import</span> <span class="n">BM25Difference</span>
<span class="kn">from</span> <span class="nn">scattertext</span> <span class="k">import</span> <span class="n">SampleCorpora</span>
<span class="kn">from</span> <span class="nn">scattertext</span> <span class="k">import</span> <span class="n">Scalers</span><span class="p">,</span> <span class="n">ScatterChart</span>
<span class="kn">from</span> <span class="nn">scattertext</span> <span class="k">import</span> <span class="n">termranking</span>
<span class="kn">from</span> <span class="nn">scattertext.AsianNLP</span> <span class="k">import</span> <span class="n">chinese_nlp</span><span class="p">,</span> <span class="n">japanese_nlp</span>
<span class="kn">from</span> <span class="nn">scattertext.AutoTermSelector</span> <span class="k">import</span> <span class="n">AutoTermSelector</span>
<span class="kn">from</span> <span class="nn">scattertext.CSRMatrixTools</span> <span class="k">import</span> <span class="n">CSRMatrixFactory</span>
<span class="kn">from</span> <span class="nn">scattertext.Common</span> <span class="k">import</span> <span class="n">DEFAULT_MINIMUM_TERM_FREQUENCY</span><span class="p">,</span> <span class="n">DEFAULT_PMI_THRESHOLD_COEFFICIENT</span>
<span class="kn">from</span> <span class="nn">scattertext.Corpus</span> <span class="k">import</span> <span class="n">Corpus</span>
<span class="kn">from</span> <span class="nn">scattertext.CorpusFromPandas</span> <span class="k">import</span> <span class="n">CorpusFromPandas</span>
<span class="kn">from</span> <span class="nn">scattertext.CorpusFromParsedDocuments</span> <span class="k">import</span> <span class="n">CorpusFromParsedDocuments</span>
<span class="kn">from</span> <span class="nn">scattertext.CorpusFromScikit</span> <span class="k">import</span> <span class="n">CorpusFromScikit</span>
<span class="kn">from</span> <span class="nn">scattertext.Formatter</span> <span class="k">import</span> <span class="n">large_int_format</span><span class="p">,</span> <span class="n">round_downer</span>
<span class="kn">from</span> <span class="nn">scattertext.ParsedCorpus</span> <span class="k">import</span> <span class="n">ParsedCorpus</span>
<span class="kn">from</span> <span class="nn">scattertext.PriorFactory</span> <span class="k">import</span> <span class="n">PriorFactory</span>
<span class="kn">from</span> <span class="nn">scattertext.Scalers</span> <span class="k">import</span> <span class="n">percentile_alphabetical</span><span class="p">,</span> <span class="n">scale_neg_1_to_1_with_zero_mean_rank_abs_max</span><span class="p">,</span> \
	<span class="n">scale_neg_1_to_1_with_zero_mean</span><span class="p">,</span> <span class="n">dense_rank</span>
<span class="kn">from</span> <span class="nn">scattertext.Scalers</span> <span class="k">import</span> <span class="n">scale_neg_1_to_1_with_zero_mean_abs_max</span><span class="p">,</span> <span class="n">scale</span>
<span class="kn">from</span> <span class="nn">scattertext.ScatterChart</span> <span class="k">import</span> <span class="n">ScatterChart</span>
<span class="kn">from</span> <span class="nn">scattertext.ScatterChartExplorer</span> <span class="k">import</span> <span class="n">ScatterChartExplorer</span>
<span class="kn">from</span> <span class="nn">scattertext.TermDocMatrix</span> <span class="k">import</span> <span class="n">TermDocMatrix</span>
<span class="kn">from</span> <span class="nn">scattertext.TermDocMatrixFactory</span> <span class="k">import</span> <span class="n">TermDocMatrixFactory</span><span class="p">,</span> <span class="n">FeatsFromDoc</span>
<span class="kn">from</span> <span class="nn">scattertext.TermDocMatrixFilter</span> <span class="k">import</span> <span class="n">TermDocMatrixFilter</span><span class="p">,</span> <span class="n">filter_bigrams_by_pmis</span>
<span class="kn">from</span> <span class="nn">scattertext.TermDocMatrixFromPandas</span> <span class="k">import</span> <span class="n">TermDocMatrixFromPandas</span>
<span class="kn">from</span> <span class="nn">scattertext.TermDocMatrixFromScikit</span> <span class="k">import</span> <span class="n">TermDocMatrixFromScikit</span>
<span class="kn">from</span> <span class="nn">scattertext.WhitespaceNLP</span> <span class="k">import</span> <span class="n">whitespace_nlp</span><span class="p">,</span> <span class="n">whitespace_nlp_with_sentences</span><span class="p">,</span> \
	<span class="n">tweet_tokenzier_factory</span>
<span class="kn">from</span> <span class="nn">scattertext.external.phrasemachine</span> <span class="k">import</span> <span class="n">phrasemachine</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromGeneralInquirer</span> <span class="k">import</span> <span class="n">FeatsFromGeneralInquirer</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromOnlyEmpath</span> <span class="k">import</span> <span class="n">FeatsFromOnlyEmpath</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromSpacyDoc</span> <span class="k">import</span> <span class="n">FeatsFromSpacyDoc</span>
<span class="kn">from</span> <span class="nn">scattertext.features.UnigramsFromSpacyDoc</span> <span class="k">import</span> <span class="n">UnigramsFromSpacyDoc</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromSpacyDocAndEmpath</span> <span class="k">import</span> <span class="n">FeatsFromSpacyDocAndEmpath</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromSpacyDocOnlyEmoji</span> <span class="k">import</span> <span class="n">FeatsFromSpacyDocOnlyEmoji</span>
<span class="kn">from</span> <span class="nn">scattertext.features.FeatsFromSpacyDocOnlyNounChunks</span> <span class="k">import</span> <span class="n">FeatsFromSpacyDocOnlyNounChunks</span>
<span class="kn">from</span> <span class="nn">scattertext.features.PhraseMachinePhrases</span> \
	<span class="kn">import</span> <span class="nn">PhraseMachinePhrases</span><span class="o">,</span> <span class="nn">PhraseMachinePhrasesAndUnigrams</span>
<span class="kn">from</span> <span class="nn">scattertext.indexstore</span> <span class="k">import</span> <span class="n">IndexStoreFromDict</span>
<span class="kn">from</span> <span class="nn">scattertext.indexstore</span> <span class="k">import</span> <span class="n">IndexStoreFromList</span>
<span class="kn">from</span> <span class="nn">scattertext.indexstore.IndexStore</span> <span class="k">import</span> <span class="n">IndexStore</span>
<span class="kn">from</span> <span class="nn">scattertext.representations.Word2VecFromParsedCorpus</span> <span class="k">import</span> <span class="n">Word2VecFromParsedCorpus</span><span class="p">,</span> \
	<span class="n">Word2VecFromParsedCorpusBigrams</span>
<span class="kn">from</span> <span class="nn">scattertext.semioticsquare</span> <span class="k">import</span> <span class="n">SemioticSquare</span><span class="p">,</span> <span class="n">FourSquareAxis</span>
<span class="kn">from</span> <span class="nn">scattertext.semioticsquare.FourSquare</span> <span class="k">import</span> <span class="n">FourSquare</span>
<span class="kn">from</span> <span class="nn">scattertext.termranking</span> <span class="k">import</span> <span class="n">OncePerDocFrequencyRanker</span>
<span class="kn">from</span> <span class="nn">scattertext.termscoring.RankDifference</span> <span class="k">import</span> <span class="n">RankDifference</span>
<span class="kn">from</span> <span class="nn">scattertext.termscoring.ScaledFScore</span> <span class="k">import</span> <span class="n">InvalidScalerException</span><span class="p">,</span> <span class="n">ScaledFScorePresets</span><span class="p">,</span> \
	<span class="n">ScaledFZScore</span><span class="p">,</span> <span class="n">ScaledFZScorePrior</span><span class="p">,</span> <span class="n">ScaledFScorePresetsNeg1To1</span>
<span class="kn">from</span> <span class="nn">scattertext.termsignificance.LogOddsRatioAddOne</span> <span class="k">import</span> <span class="n">LogOddsRatioAddOne</span>
<span class="kn">from</span> <span class="nn">scattertext.termsignificance.LogOddsRatioInformativeDirichletPiror</span> \
	<span class="kn">import</span> <span class="nn">LogOddsRatioInformativeDirichletPrior</span>
<span class="kn">from</span> <span class="nn">scattertext.termsignificance.LogOddsRatioUninformativeDirichletPrior</span> \
	<span class="kn">import</span> <span class="nn">LogOddsRatioUninformativeDirichletPrior</span>
<span class="kn">from</span> <span class="nn">scattertext.termsignificance.ScaledFScoreSignificance</span> <span class="k">import</span> <span class="n">ScaledFScoreSignificance</span>
<span class="kn">from</span> <span class="nn">scattertext.termsignificance.TermSignificance</span> <span class="k">import</span> <span class="n">TermSignificance</span>
<span class="kn">from</span> <span class="nn">scattertext.viz</span> <span class="k">import</span> <span class="n">VizDataAdapter</span><span class="p">,</span> <span class="n">HTMLVisualizationAssembly</span>
<span class="kn">from</span> <span class="nn">scattertext.viz.HTMLSemioticSquareViz</span> <span class="k">import</span> <span class="n">HTMLSemioticSquareViz</span>
<span class="kn">from</span> <span class="nn">scattertext.semioticsquare.FourSquareAxis</span> <span class="k">import</span> <span class="n">FourSquareAxes</span>
<span class="kn">from</span> <span class="nn">scattertext.termcompaction.ClassPercentageCompactor</span> <span class="k">import</span> <span class="n">ClassPercentageCompactor</span>
<span class="kn">from</span> <span class="nn">scattertext.termcompaction.CompactTerms</span> <span class="k">import</span> <span class="n">CompactTerms</span>
<span class="kn">from</span> <span class="nn">scattertext.termcompaction.PhraseSelector</span> <span class="k">import</span> <span class="n">PhraseSelector</span>
<span class="kn">from</span> <span class="nn">scattertext.topicmodel.SentencesForTopicModeling</span> <span class="k">import</span> <span class="n">SentencesForTopicModeling</span>

<div class="viewcode-block" id="produce_scattertext_html"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_scattertext_html">[docs]</a><span class="k">def</span> <span class="nf">produce_scattertext_html</span><span class="p">(</span><span class="n">term_doc_matrix</span><span class="p">,</span>
                             <span class="n">category</span><span class="p">,</span>
                             <span class="n">category_name</span><span class="p">,</span>
                             <span class="n">not_category_name</span><span class="p">,</span>
                             <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;https&#39;</span><span class="p">,</span>
                             <span class="n">minimum_term_frequency</span><span class="o">=</span><span class="n">DEFAULT_MINIMUM_TERM_FREQUENCY</span><span class="p">,</span>
                             <span class="n">pmi_threshold_coefficient</span><span class="o">=</span><span class="n">DEFAULT_PMI_THRESHOLD_COEFFICIENT</span><span class="p">,</span>
                             <span class="n">max_terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">filter_unigrams</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">height_in_pixels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">width_in_pixels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">term_ranker</span><span class="o">=</span><span class="n">termranking</span><span class="o">.</span><span class="n">AbsoluteFrequencyRanker</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;Returns html code of visualization.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	term_doc_matrix : TermDocMatrix</span>
<span class="sd">		Corpus to use</span>
<span class="sd">	category : str</span>
<span class="sd">		name of category column</span>
<span class="sd">	category_name: str</span>
<span class="sd">		name of category to mine for</span>
<span class="sd">	not_category_name: str</span>
<span class="sd">		name of everything that isn&#39;t in category</span>
<span class="sd">	protocol : str</span>
<span class="sd">		optional, used prototcol of , http or https</span>
<span class="sd">	minimum_term_frequency : int, optional</span>
<span class="sd">		Minimum number of times word needs to appear to make it into visualization.</span>
<span class="sd">	pmi_threshold_coefficient : int, optional</span>
<span class="sd">		Filter out bigrams with a PMI of &lt; 2 * pmi_threshold_coefficient. Default is 6.</span>
<span class="sd">	max_terms : int, optional</span>
<span class="sd">		Maximum number of terms to include in visualization.</span>
<span class="sd">	filter_unigrams : bool</span>
<span class="sd">		default False, do we filter unigrams that only occur in one bigram</span>
<span class="sd">	width_in_pixels: int</span>
<span class="sd">		width of viz in pixels, if None, default to JS&#39;s choice</span>
<span class="sd">	height_in_pixels: int</span>
<span class="sd">		height of viz in pixels, if None, default to JS&#39;s choice</span>
<span class="sd">	term_ranker : TermRanker</span>
<span class="sd">			TermRanker class for determining term frequency ranks.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">scatter_chart_data</span> <span class="o">=</span> <span class="n">ScatterChart</span><span class="p">(</span><span class="n">term_doc_matrix</span><span class="o">=</span><span class="n">term_doc_matrix</span><span class="p">,</span>
	                                  <span class="n">minimum_term_frequency</span><span class="o">=</span><span class="n">minimum_term_frequency</span><span class="p">,</span>
	                                  <span class="n">pmi_threshold_coefficient</span><span class="o">=</span><span class="n">pmi_threshold_coefficient</span><span class="p">,</span>
	                                  <span class="n">filter_unigrams</span><span class="o">=</span><span class="n">filter_unigrams</span><span class="p">,</span>
	                                  <span class="n">max_terms</span><span class="o">=</span><span class="n">max_terms</span><span class="p">,</span>
	                                  <span class="n">term_ranker</span><span class="o">=</span><span class="n">term_ranker</span><span class="p">)</span> \
		<span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
	           <span class="n">category_name</span><span class="o">=</span><span class="n">category_name</span><span class="p">,</span>
	           <span class="n">not_category_name</span><span class="o">=</span><span class="n">not_category_name</span><span class="p">,</span>
	           <span class="n">transform</span><span class="o">=</span><span class="n">percentile_alphabetical</span><span class="p">)</span>
	<span class="n">html</span> <span class="o">=</span> <span class="n">HTMLVisualizationAssembly</span><span class="p">(</span><span class="n">VizDataAdapter</span><span class="p">(</span><span class="n">scatter_chart_data</span><span class="p">),</span>
	                                 <span class="n">width_in_pixels</span><span class="p">,</span>
	                                 <span class="n">height_in_pixels</span><span class="p">)</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">html</span></div>


<div class="viewcode-block" id="produce_scattertext_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_scattertext_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_scattertext_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                                 <span class="n">category</span><span class="p">,</span>
                                 <span class="n">category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">not_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;https&#39;</span><span class="p">,</span>
                                 <span class="n">pmi_threshold_coefficient</span><span class="o">=</span><span class="n">DEFAULT_MINIMUM_TERM_FREQUENCY</span><span class="p">,</span>
                                 <span class="n">minimum_term_frequency</span><span class="o">=</span><span class="n">DEFAULT_PMI_THRESHOLD_COEFFICIENT</span><span class="p">,</span>
                                 <span class="n">minimum_not_category_term_frequency</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">max_terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">filter_unigrams</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">height_in_pixels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">width_in_pixels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">max_snippets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">max_docs_per_category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">scores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">x_coords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">y_coords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">original_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">original_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">rescale_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">rescale_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">singleScoreMode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">reverse_sort_scores_for_not_category</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">use_full_doc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">transform</span><span class="o">=</span><span class="n">percentile_alphabetical</span><span class="p">,</span>
                                 <span class="n">jitter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">gray_zero_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">term_ranker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">asian_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">use_non_text_features</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">show_top_terms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">show_characteristic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">word_vec_use_p_vals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">max_p_val</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                 <span class="n">p_value_colors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">term_significance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">save_svg_button</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">d3_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">d3_scale_chromatic_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">pmi_filter_thresold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">alternative_text_field</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">terms_to_include</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">semiotic_square</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">not_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">neutral_categories</span><span class="o">=</span><span class="p">[],</span>
                                 <span class="n">extra_categories</span><span class="o">=</span><span class="p">[],</span>
                                 <span class="n">show_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">neutral_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">get_tooltip_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">x_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">y_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">color_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">term_scorer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">show_extra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">extra_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">censor_points</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">center_label_over_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">x_axis_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">y_axis_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">topic_model_term_lists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">topic_model_preview_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                 <span class="n">vertical_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">characteristic_scorer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;Returns html code of visualization.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	corpus : Corpus</span>
<span class="sd">		Corpus to use.</span>
<span class="sd">	category : str</span>
<span class="sd">		Name of category column as it appears in original data frame.</span>
<span class="sd">	category_name : str</span>
<span class="sd">		Name of category to use.  E.g., &quot;5-star reviews.&quot;</span>
<span class="sd">		Optional, defaults to category name.</span>
<span class="sd">	not_category_name : str</span>
<span class="sd">		Name of everything that isn&#39;t in category.  E.g., &quot;Below 5-star reviews&quot;.</span>
<span class="sd">		Optional defaults to &quot;N(n)ot &quot; + category_name, with the case of the &#39;n&#39; dependent</span>
<span class="sd">		on the case of the first letter in category_name.</span>
<span class="sd">	protocol : str, optional</span>
<span class="sd">		Protocol to use.  Either http or https.  Default is https.</span>
<span class="sd">	pmi_threshold_coefficient : int, optional</span>
<span class="sd">		Filter out bigrams with a PMI of &lt; 2 * pmi_threshold_coefficient. Default is 6</span>
<span class="sd">	minimum_term_frequency : int, optional</span>
<span class="sd">		Minimum number of times word needs to appear to make it into visualization.</span>
<span class="sd">	minimum_not_category_term_frequency : int, optional</span>
<span class="sd">	  If an n-gram does not occur in the category, minimum times it</span>
<span class="sd">	   must been seen to be included. Default is 0.</span>
<span class="sd">	max_terms : int, optional</span>
<span class="sd">		Maximum number of terms to include in visualization.</span>
<span class="sd">	filter_unigrams : bool, optional</span>
<span class="sd">		Default False, do we filter out unigrams that only occur in one bigram</span>
<span class="sd">	width_in_pixels : int, optional</span>
<span class="sd">		Width of viz in pixels, if None, default to JS&#39;s choice</span>
<span class="sd">	height_in_pixels : int, optional</span>
<span class="sd">		Height of viz in pixels, if None, default to JS&#39;s choice</span>
<span class="sd">	max_snippets : int, optional</span>
<span class="sd">		Maximum number of snippets to show when term is clicked.  If None, all are shown.</span>
<span class="sd">	max_docs_per_category: int, optional</span>
<span class="sd">		Maximum number of documents to store per category.  If None, by default, all are stored.</span>
<span class="sd">	metadata : list, optional</span>
<span class="sd">		list of meta data strings that will be included for each document</span>
<span class="sd">	scores : np.array, optional</span>
<span class="sd">		Array of term scores or None.</span>
<span class="sd">	x_coords : np.array, optional</span>
<span class="sd">		Array of term x-axis positions or None.  Must be in [0,1].</span>
<span class="sd">		If present, y_coords must also be present.</span>
<span class="sd">	y_coords : np.array, optional</span>
<span class="sd">		Array of term y-axis positions or None.  Must be in [0,1].</span>
<span class="sd">		If present, x_coords must also be present.</span>
<span class="sd">	original_x : array-like</span>
<span class="sd">		Original, unscaled x-values.  Defaults to x_coords</span>
<span class="sd">	original_y : array-like</span>
<span class="sd">		Original, unscaled y-values.  Defaults to y_coords</span>
<span class="sd">	rescale_x : lambda list[0,1]: list[0,1], optional</span>
<span class="sd">		Array of term x-axis positions or None.  Must be in [0,1].</span>
<span class="sd">		Rescales x-axis after filtering</span>
<span class="sd">	rescale_y : lambda list[0,1]: list[0,1], optional</span>
<span class="sd">		Array of term y-axis positions or None.  Must be in [0,1].</span>
<span class="sd">		Rescales y-axis after filtering</span>
<span class="sd">	singleScoreMode : bool, optional</span>
<span class="sd">		Label terms based on score vs distance from corner.  Good for topic scores. Show only one color.</span>
<span class="sd">	sort_by_dist: bool, optional</span>
<span class="sd">		Label terms based distance from corner. True by default.  Negated by singleScoreMode.</span>
<span class="sd">	reverse_sort_scores_for_not_category: bool, optional</span>
<span class="sd">		If using a custom score, score the not-category class by</span>
<span class="sd">		lowest-score-as-most-predictive. Turn this off for word vector</span>
<span class="sd">		or topic similarity. Default True.</span>
<span class="sd">	use_full_doc : bool, optional</span>
<span class="sd">		Use the full document in snippets.  False by default.</span>
<span class="sd">	transform : function, optional</span>
<span class="sd">		not recommended for editing.  change the way terms are ranked.  default is st.Scalers.percentile_ordinal</span>
<span class="sd">	jitter : float, optional</span>
<span class="sd">		percentage of axis to jitter each point.  default is 0.</span>
<span class="sd">	gray_zero_scores : bool, optional</span>
<span class="sd">		If True, color points with zero-scores a light shade of grey.  False by default.</span>
<span class="sd">	term_ranker : TermRanker, optional</span>
<span class="sd">		TermRanker class for determining term frequency ranks.</span>
<span class="sd">	asian_mode : bool, optional</span>
<span class="sd">		Use a special Javascript regular expression that&#39;s specific to chinese or japanese</span>
<span class="sd">	use_non_text_features : bool, optional</span>
<span class="sd">		Show non-bag-of-words features (e.g., Empath) instead of text.  False by default.</span>
<span class="sd">	show_top_terms : bool, default True</span>
<span class="sd">		Show top terms on the left-hand side of the visualization</span>
<span class="sd">	show_characteristic: bool, default True</span>
<span class="sd">		Show characteristic terms on the far left-hand side of the visualization</span>
<span class="sd">	word_vec_use_p_vals: bool, default False</span>
<span class="sd">		Sort by harmonic mean of score and distance.</span>
<span class="sd">	max_p_val : float, default 0.1</span>
<span class="sd">		If word_vec_use_p_vals, the minimum p val to use.</span>
<span class="sd">	p_value_colors : bool, default False</span>
<span class="sd">	  Color points differently if p val is above 1-max_p_val, below max_p_val, or</span>
<span class="sd">	   in between.</span>
<span class="sd">	term_significance : TermSignificance instance or None</span>
<span class="sd">		Way of getting signfiance scores.  If None, p values will not be added.</span>
<span class="sd">	save_svg_button : bool, default False</span>
<span class="sd">		Add a save as SVG button to the page.</span>
<span class="sd">	x_label : str, default None</span>
<span class="sd">		Custom x-axis label</span>
<span class="sd">	y_label : str, default None</span>
<span class="sd">		Custom y-axis label</span>
<span class="sd">	d3_url, str, None by default.  The url (or path) of d3.</span>
<span class="sd">		URL of d3, to be inserted into &lt;script src=&quot;...&quot;/&gt;.  Overrides `protocol`.</span>
<span class="sd">	  By default, this is `DEFAULT_D3_URL` declared in `HTMLVisualizationAssembly`.</span>
<span class="sd">	d3_scale_chromatic_url, str, None by default.  Overrides `protocol`.</span>
<span class="sd">	  URL of d3 scale chromatic, to be inserted into &lt;script src=&quot;...&quot;/&gt;</span>
<span class="sd">	  By default, this is `DEFAULT_D3_SCALE_CHROMATIC` declared in `HTMLVisualizationAssembly`.</span>
<span class="sd">	pmi_filter_thresold : (DEPRECATED) int, None by default</span>
<span class="sd">	  DEPRECATED.  Use pmi_threshold_coefficient instead.</span>
<span class="sd">	alternative_text_field : str or None, optional</span>
<span class="sd">		Field in from dataframe used to make corpus to display in place of parsed text. Only</span>
<span class="sd">		can be used if corpus is a ParsedCorpus instance.</span>
<span class="sd">	terms_to_include : list or None, optional</span>
<span class="sd">		Whitelist of terms to include in visualization.</span>
<span class="sd">	semiotic_square : SemioticSquare</span>
<span class="sd">		None by default.  SemioticSquare based on corpus.  Includes square above visualization.</span>
<span class="sd">	num_terms_semiotic_square : int</span>
<span class="sd">		10 by default. Number of terms to show in semiotic square.</span>
<span class="sd">		Only active if semiotic square is present.</span>
<span class="sd">	not_categories : list</span>
<span class="sd">		All categories other than category by default.  Documents labeled</span>
<span class="sd">		with remaining category.</span>
<span class="sd">	neutral_categories : list</span>
<span class="sd">		[] by default.  Documents labeled neutral.</span>
<span class="sd">	extra_categories : list</span>
<span class="sd">		[] by default.  Documents labeled extra.</span>
<span class="sd">	show_neutral : bool</span>
<span class="sd">		False by default.  Show a third column listing contexts in the</span>
<span class="sd">		neutral categories.</span>
<span class="sd">	neutral_category_name : str</span>
<span class="sd">		&quot;Neutral&quot; by default. Only active if show_neutral is True.  Name of the neutral</span>
<span class="sd">		column.</span>
<span class="sd">	get_tooltip_content : str</span>
<span class="sd">		Javascript function to control content of tooltip.  Function takes a parameter</span>
<span class="sd">		which is a dictionary entry produced by `ScatterChartExplorer.to_dict` and</span>
<span class="sd">		returns a string.</span>
<span class="sd">	x_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on x-axis. Low, medium, high are defaults.</span>
<span class="sd">	y_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on y-axis. Low, medium, high are defaults.</span>
<span class="sd">	color_func : str, default None</span>
<span class="sd">		Javascript function to control color of a point.  Function takes a parameter</span>
<span class="sd">		which is a dictionary entry produced by `ScatterChartExplorer.to_dict` and</span>
<span class="sd">		returns a string.</span>
<span class="sd">	term_scorer : Object, default None</span>
<span class="sd">		In lieu of scores, object with a get_scores(a,b) function that returns a set of scores,</span>
<span class="sd">		where a and b are term counts.  Scorer optionally has a get_term_freqs function.</span>
<span class="sd">	show_axes : bool, default True</span>
<span class="sd">		Show the ticked axes on the plot.  If false, show inner axes as a crosshair.</span>
<span class="sd">	show_extra : bool</span>
<span class="sd">		False by default.  Show a fourth column listing contexts in the</span>
<span class="sd">		extra categories.</span>
<span class="sd">	extra_category_name : str, default None</span>
<span class="sd">		&quot;Extra&quot; by default. Only active if show_neutral is True and show_extra is True.  Name</span>
<span class="sd">		of the extra column.</span>
<span class="sd">	censor_points : bool, default True</span>
<span class="sd">		Don&#39;t label over points.</span>
<span class="sd">	center_label_over_points : bool, default False</span>
<span class="sd">		Center a label over points, or try to find a position near a point that</span>
<span class="sd">		doesn&#39;t overlap anything else.</span>
<span class="sd">	x_axis_labels: list, default None</span>
<span class="sd">		List of string value-labels to show at evenly spaced intervals on the x-axis.</span>
<span class="sd">		Low, medium, high are defaults.</span>
<span class="sd">	y_axis_labels : list, default None</span>
<span class="sd">		List of string value-labels to show at evenly spaced intervals on the y-axis.</span>
<span class="sd">		Low, medium, high are defaults.</span>
<span class="sd">	topic_model_term_lists : dict default None</span>
<span class="sd">		Dict of metadata name (str) -&gt; List of string terms in metatdata. These will be bolded</span>
<span class="sd">		in query in context results.</span>
<span class="sd">	topic_model_preview_size : int default 10</span>
<span class="sd">		Number of terms in topic model to show as a preview.</span>
<span class="sd">	vertical_lines : list default None</span>
<span class="sd">		List of floats corresponding to points on the x-axis to draw vertical lines</span>
<span class="sd">	characteristic_scorer : CharacteristicScorer default None</span>
<span class="sd">		Used for bg scores</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	str</span>
<span class="sd">	html of visualization</span>

<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="k">if</span> <span class="n">singleScoreMode</span> <span class="ow">or</span> <span class="n">word_vec_use_p_vals</span><span class="p">:</span>
		<span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;d3.interpolatePurples&#39;</span>
	<span class="k">if</span> <span class="n">singleScoreMode</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">sort_by_dist</span><span class="p">:</span>
		<span class="n">sort_by_dist</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">sort_by_dist</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="k">if</span> <span class="n">term_ranker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">term_ranker</span> <span class="o">=</span> <span class="n">termranking</span><span class="o">.</span><span class="n">AbsoluteFrequencyRanker</span>

	<span class="n">category_name</span><span class="p">,</span> <span class="n">not_category_name</span> <span class="o">=</span> <span class="n">get_category_names</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="n">not_categories</span><span class="p">,</span> <span class="n">not_category_name</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">not_categories</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">not_categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">get_categories</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">category</span><span class="p">]</span>

	<span class="k">if</span> <span class="n">term_scorer</span><span class="p">:</span>
		<span class="c1"># tdf = term_ranker(corpus).get_ranks()</span>
		<span class="n">tdf</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">apply_ranker</span><span class="p">(</span><span class="n">term_ranker</span><span class="p">)</span>
		<span class="n">cat_freqs</span> <span class="o">=</span> <span class="n">tdf</span><span class="p">[</span><span class="n">category</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">not_categories</span><span class="p">:</span>
			<span class="n">not_cat_freqs</span> <span class="o">=</span> <span class="n">tdf</span><span class="p">[[</span><span class="n">c</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">not_categories</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">not_cat_freqs</span> <span class="o">=</span> <span class="n">tdf</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">tdf</span><span class="p">[</span><span class="n">category</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span><span class="p">]</span>
		<span class="n">scores</span> <span class="o">=</span> <span class="n">term_scorer</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">cat_freqs</span><span class="p">,</span> <span class="n">not_cat_freqs</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">pmi_filter_thresold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">pmi_threshold_coefficient</span> <span class="o">=</span> <span class="n">pmi_filter_thresold</span>
		<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
			<span class="s2">&quot;The argument name &#39;pmi_filter_thresold&#39; has been deprecated. Use &#39;pmi_threshold_coefficient&#39; in its place&quot;</span><span class="p">,</span>
			<span class="ne">DeprecationWarning</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">use_non_text_features</span><span class="p">:</span>
		<span class="n">pmi_threshold_coefficient</span> <span class="o">=</span> <span class="mi">0</span>

	<span class="n">scatter_chart_explorer</span> <span class="o">=</span> <span class="n">ScatterChartExplorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
	                                              <span class="n">minimum_term_frequency</span><span class="o">=</span><span class="n">minimum_term_frequency</span><span class="p">,</span>
	                                              <span class="n">minimum_not_category_term_frequency</span><span class="o">=</span><span class="n">minimum_not_category_term_frequency</span><span class="p">,</span>
	                                              <span class="n">pmi_threshold_coefficient</span><span class="o">=</span><span class="n">pmi_threshold_coefficient</span><span class="p">,</span>
	                                              <span class="n">filter_unigrams</span><span class="o">=</span><span class="n">filter_unigrams</span><span class="p">,</span>
	                                              <span class="n">jitter</span><span class="o">=</span><span class="n">jitter</span><span class="p">,</span>
	                                              <span class="n">max_terms</span><span class="o">=</span><span class="n">max_terms</span><span class="p">,</span>
	                                              <span class="n">term_ranker</span><span class="o">=</span><span class="n">term_ranker</span><span class="p">,</span>
	                                              <span class="n">use_non_text_features</span><span class="o">=</span><span class="n">use_non_text_features</span><span class="p">,</span>
	                                              <span class="n">term_significance</span><span class="o">=</span><span class="n">term_significance</span><span class="p">,</span>
	                                              <span class="n">terms_to_include</span><span class="o">=</span><span class="n">terms_to_include</span><span class="p">,)</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">x_coords</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
			<span class="ow">or</span> <span class="p">(</span><span class="n">y_coords</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">x_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Both x_coords and y_coords need to be passed or both left blank&quot;</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">x_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">scatter_chart_explorer</span><span class="o">.</span><span class="n">inject_coordinates</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span>
		                                          <span class="n">y_coords</span><span class="p">,</span>
		                                          <span class="n">rescale_x</span><span class="o">=</span><span class="n">rescale_x</span><span class="p">,</span>
		                                          <span class="n">rescale_y</span><span class="o">=</span><span class="n">rescale_y</span><span class="p">,</span>
		                                          <span class="n">original_x</span><span class="o">=</span><span class="n">original_x</span><span class="p">,</span>
		                                          <span class="n">original_y</span><span class="o">=</span><span class="n">original_y</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">topic_model_term_lists</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">scatter_chart_explorer</span><span class="o">.</span><span class="n">inject_metadata_term_lists</span><span class="p">(</span><span class="n">topic_model_term_lists</span><span class="p">)</span>
	<span class="n">html_base</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="k">if</span> <span class="n">semiotic_square</span><span class="p">:</span>
		<span class="n">html_base</span> <span class="o">=</span> <span class="n">get_semiotic_square_html</span><span class="p">(</span><span class="n">num_terms_semiotic_square</span><span class="p">,</span>
		                                     <span class="n">semiotic_square</span><span class="p">)</span>
	<span class="n">scatter_chart_data</span> <span class="o">=</span> <span class="n">scatter_chart_explorer</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
	                                                    <span class="n">category_name</span><span class="o">=</span><span class="n">category_name</span><span class="p">,</span>
	                                                    <span class="n">not_category_name</span><span class="o">=</span><span class="n">not_category_name</span><span class="p">,</span>
	                                                    <span class="n">not_categories</span><span class="o">=</span><span class="n">not_categories</span><span class="p">,</span>
	                                                    <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
	                                                    <span class="n">scores</span><span class="o">=</span><span class="n">scores</span><span class="p">,</span>
	                                                    <span class="n">max_docs_per_category</span><span class="o">=</span><span class="n">max_docs_per_category</span><span class="p">,</span>
	                                                    <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
	                                                    <span class="n">alternative_text_field</span><span class="o">=</span><span class="n">alternative_text_field</span><span class="p">,</span>
	                                                    <span class="n">neutral_category_name</span><span class="o">=</span><span class="n">neutral_category_name</span><span class="p">,</span>
	                                                    <span class="n">extra_category_name</span><span class="o">=</span><span class="n">extra_category_name</span><span class="p">,</span>
	                                                    <span class="n">neutral_categories</span><span class="o">=</span><span class="n">neutral_categories</span><span class="p">,</span>
	                                                    <span class="n">extra_categories</span><span class="o">=</span><span class="n">extra_categories</span><span class="p">,</span>
	                                                    <span class="n">background_scorer</span><span class="o">=</span><span class="n">characteristic_scorer</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">HTMLVisualizationAssembly</span><span class="p">(</span><span class="n">VizDataAdapter</span><span class="p">(</span><span class="n">scatter_chart_data</span><span class="p">),</span>
	                                 <span class="n">width_in_pixels</span><span class="o">=</span><span class="n">width_in_pixels</span><span class="p">,</span>
	                                 <span class="n">height_in_pixels</span><span class="o">=</span><span class="n">height_in_pixels</span><span class="p">,</span>
	                                 <span class="n">max_snippets</span><span class="o">=</span><span class="n">max_snippets</span><span class="p">,</span>
	                                 <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
	                                 <span class="n">grey_zero_scores</span><span class="o">=</span><span class="n">gray_zero_scores</span><span class="p">,</span>
	                                 <span class="n">sort_by_dist</span><span class="o">=</span><span class="n">sort_by_dist</span><span class="p">,</span>
	                                 <span class="n">reverse_sort_scores_for_not_category</span><span class="o">=</span><span class="n">reverse_sort_scores_for_not_category</span><span class="p">,</span>
	                                 <span class="n">use_full_doc</span><span class="o">=</span><span class="n">use_full_doc</span><span class="p">,</span>
	                                 <span class="n">asian_mode</span><span class="o">=</span><span class="n">asian_mode</span><span class="p">,</span>
	                                 <span class="n">use_non_text_features</span><span class="o">=</span><span class="n">use_non_text_features</span><span class="p">,</span>
	                                 <span class="n">show_characteristic</span><span class="o">=</span><span class="n">show_characteristic</span><span class="p">,</span>
	                                 <span class="n">show_top_terms</span><span class="o">=</span><span class="n">show_top_terms</span><span class="p">,</span>
	                                 <span class="n">word_vec_use_p_vals</span><span class="o">=</span><span class="n">word_vec_use_p_vals</span><span class="p">,</span>
	                                 <span class="n">max_p_val</span><span class="o">=</span><span class="n">max_p_val</span><span class="p">,</span>
	                                 <span class="n">save_svg_button</span><span class="o">=</span><span class="n">save_svg_button</span><span class="p">,</span>
	                                 <span class="n">p_value_colors</span><span class="o">=</span><span class="n">p_value_colors</span><span class="p">,</span>
	                                 <span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
	                                 <span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span>
	                                 <span class="n">show_neutral</span><span class="o">=</span><span class="n">show_neutral</span><span class="p">,</span>
	                                 <span class="n">get_tooltip_content</span><span class="o">=</span><span class="n">get_tooltip_content</span><span class="p">,</span>
	                                 <span class="n">x_axis_values</span><span class="o">=</span><span class="n">x_axis_values</span><span class="p">,</span>
	                                 <span class="n">y_axis_values</span><span class="o">=</span><span class="n">y_axis_values</span><span class="p">,</span>
	                                 <span class="n">color_func</span><span class="o">=</span><span class="n">color_func</span><span class="p">,</span>
	                                 <span class="n">show_axes</span><span class="o">=</span><span class="n">show_axes</span><span class="p">,</span>
	                                 <span class="n">show_extra</span><span class="o">=</span><span class="n">show_extra</span><span class="p">,</span>
	                                 <span class="n">do_censor_points</span><span class="o">=</span><span class="n">censor_points</span><span class="p">,</span>
	                                 <span class="n">center_label_over_points</span><span class="o">=</span><span class="n">center_label_over_points</span><span class="p">,</span>
	                                 <span class="n">x_axis_labels</span><span class="o">=</span><span class="n">x_axis_labels</span><span class="p">,</span>
	                                 <span class="n">y_axis_labels</span><span class="o">=</span><span class="n">y_axis_labels</span><span class="p">,</span>
	                                 <span class="n">topic_model_preview_size</span><span class="o">=</span><span class="n">topic_model_preview_size</span><span class="p">,</span>
	                                 <span class="n">vertical_lines</span><span class="o">=</span><span class="n">vertical_lines</span><span class="p">)</span> \
		<span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">,</span>
	           <span class="n">d3_url</span><span class="o">=</span><span class="n">d3_url</span><span class="p">,</span>
	           <span class="n">d3_scale_chromatic_url</span><span class="o">=</span><span class="n">d3_scale_chromatic_url</span><span class="p">,</span>
	           <span class="n">html_base</span><span class="o">=</span><span class="n">html_base</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_category_names"><a class="viewcode-back" href="../scattertext.html#scattertext.get_category_names">[docs]</a><span class="k">def</span> <span class="nf">get_category_names</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="n">not_categories</span><span class="p">,</span> <span class="n">not_category_name</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">category_name</span> <span class="o">=</span> <span class="n">category</span>
	<span class="k">if</span> <span class="n">not_category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">not_categories</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_categories</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
			<span class="n">not_category_name</span> <span class="o">=</span> <span class="n">not_categories</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">not_category_name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Not&#39;</span> <span class="k">if</span> <span class="n">category_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;not&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">category_name</span>
	<span class="k">return</span> <span class="n">category_name</span><span class="p">,</span> <span class="n">not_category_name</span></div>


<div class="viewcode-block" id="get_semiotic_square_html"><a class="viewcode-back" href="../scattertext.html#scattertext.get_semiotic_square_html">[docs]</a><span class="k">def</span> <span class="nf">get_semiotic_square_html</span><span class="p">(</span><span class="n">num_terms_semiotic_square</span><span class="p">,</span> <span class="n">semiotic_square</span><span class="p">):</span>
	<span class="n">semiotic_square_html</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="k">if</span> <span class="n">semiotic_square</span><span class="p">:</span>
		<span class="n">semiotic_square_viz</span> <span class="o">=</span> <span class="n">HTMLSemioticSquareViz</span><span class="p">(</span><span class="n">semiotic_square</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">num_terms_semiotic_square</span><span class="p">:</span>
			<span class="n">semiotic_square_html</span> <span class="o">=</span> <span class="n">semiotic_square_viz</span><span class="o">.</span><span class="n">get_html</span><span class="p">(</span><span class="n">num_terms_semiotic_square</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">semiotic_square_html</span> <span class="o">=</span> <span class="n">semiotic_square_viz</span><span class="o">.</span><span class="n">get_html</span><span class="p">()</span>
	<span class="k">return</span> <span class="n">semiotic_square_html</span></div>


<div class="viewcode-block" id="word_similarity_explorer_gensim"><a class="viewcode-back" href="../scattertext.html#scattertext.word_similarity_explorer_gensim">[docs]</a><span class="k">def</span> <span class="nf">word_similarity_explorer_gensim</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                                    <span class="n">category</span><span class="p">,</span>
                                    <span class="n">target_term</span><span class="p">,</span>
                                    <span class="n">category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">not_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">word2vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                                    <span class="n">max_p_val</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                    <span class="n">term_significance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		corpus : Corpus</span>
<span class="sd">			Corpus to use.</span>
<span class="sd">		category : str</span>
<span class="sd">			Name of category column as it appears in original data frame.</span>
<span class="sd">		category_name : str</span>
<span class="sd">			Name of category to use.  E.g., &quot;5-star reviews.&quot;</span>
<span class="sd">		not_category_name : str</span>
<span class="sd">			Name of everything that isn&#39;t in category.  E.g., &quot;Below 5-star reviews&quot;.</span>
<span class="sd">		target_term : str</span>
<span class="sd">			Word or phrase for semantic similarity comparison</span>
<span class="sd">		word2vec : word2vec.Word2Vec</span>
<span class="sd">		  Gensim-compatible Word2Vec model of lower-cased corpus. If none, o</span>
<span class="sd">		  ne will be trained using Word2VecFromParsedCorpus(corpus).train()</span>
<span class="sd">		alpha : float, default = 0.01</span>
<span class="sd">			Uniform dirichlet prior for p-value calculation</span>
<span class="sd">		max_p_val : float, default = 0.1</span>
<span class="sd">			Max p-val to use find set of terms for similarity calculation</span>
<span class="sd">		term_significance : TermSignificance</span>
<span class="sd">			Significance finder</span>

<span class="sd">		Remaining arguments are from `produce_scattertext_explorer`.</span>
<span class="sd">		Returns</span>
<span class="sd">		-------</span>
<span class="sd">			str, html of visualization</span>
<span class="sd">		&#39;&#39;&#39;</span>

	<span class="k">if</span> <span class="n">word2vec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">word2vec</span> <span class="o">=</span> <span class="n">Word2VecFromParsedCorpus</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

	<span class="k">if</span> <span class="n">term_significance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">term_significance</span> <span class="o">=</span> <span class="n">LogOddsRatioUninformativeDirichletPrior</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
	<span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">term_significance</span><span class="p">),</span> <span class="n">TermSignificance</span><span class="p">)</span>

	<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">_term_idx_store</span><span class="o">.</span><span class="n">_i2val</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word2vec</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">target_term</span><span class="p">,</span> <span class="n">tok</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)))</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">word2vec</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">target_term</span><span class="p">,</span> <span class="n">tok_part</span><span class="p">)</span>
				                       <span class="k">for</span> <span class="n">tok_part</span> <span class="ow">in</span> <span class="n">tok</span><span class="o">.</span><span class="n">split</span><span class="p">()]))</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
	                                    <span class="n">category</span><span class="p">,</span>
	                                    <span class="n">category_name</span><span class="p">,</span>
	                                    <span class="n">not_category_name</span><span class="p">,</span>
	                                    <span class="n">scores</span><span class="o">=</span><span class="n">scores</span><span class="p">,</span>
	                                    <span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">reverse_sort_scores_for_not_category</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">word_vec_use_p_vals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
	                                    <span class="n">term_significance</span><span class="o">=</span><span class="n">term_significance</span><span class="p">,</span>
	                                    <span class="n">max_p_val</span><span class="o">=</span><span class="n">max_p_val</span><span class="p">,</span>
	                                    <span class="n">p_value_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
	                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="word_similarity_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.word_similarity_explorer">[docs]</a><span class="k">def</span> <span class="nf">word_similarity_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                             <span class="n">category</span><span class="p">,</span>
                             <span class="n">category_name</span><span class="p">,</span>
                             <span class="n">not_category_name</span><span class="p">,</span>
                             <span class="n">target_term</span><span class="p">,</span>
                             <span class="n">nlp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                             <span class="n">max_p_val</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	corpus : Corpus</span>
<span class="sd">		Corpus to use.</span>
<span class="sd">	category : str</span>
<span class="sd">		Name of category column as it appears in original data frame.</span>
<span class="sd">	category_name : str</span>
<span class="sd">		Name of category to use.  E.g., &quot;5-star reviews.&quot;</span>
<span class="sd">	not_category_name : str</span>
<span class="sd">		Name of everything that isn&#39;t in category.  E.g., &quot;Below 5-star reviews&quot;.</span>
<span class="sd">	target_term : str</span>
<span class="sd">		Word or phrase for semantic similarity comparison</span>
<span class="sd">	nlp : spaCy-like parsing function</span>
<span class="sd">		E.g., spacy.load(&#39;en&#39;), whitespace_nlp, etc...</span>
<span class="sd">	alpha : float, default = 0.01</span>
<span class="sd">		Uniform dirichlet prior for p-value calculation</span>
<span class="sd">	max_p_val : float, default = 0.1</span>
<span class="sd">		Max p-val to use find set of terms for similarity calculation</span>
<span class="sd">	Remaining arguments are from `produce_scattertext_explorer`.</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="k">if</span> <span class="n">nlp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="kn">import</span> <span class="nn">spacy</span>
		<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">)</span>

	<span class="n">base_term</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">target_term</span><span class="p">)</span>
	<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">base_term</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">nlp</span><span class="p">(</span><span class="n">tok</span><span class="p">))</span>
	                   <span class="k">for</span> <span class="n">tok</span>
	                   <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">_term_idx_store</span><span class="o">.</span><span class="n">_i2val</span><span class="p">])</span>
	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
	                                    <span class="n">category</span><span class="p">,</span>
	                                    <span class="n">category_name</span><span class="p">,</span>
	                                    <span class="n">not_category_name</span><span class="p">,</span>
	                                    <span class="n">scores</span><span class="o">=</span><span class="n">scores</span><span class="p">,</span>
	                                    <span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">reverse_sort_scores_for_not_category</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">word_vec_use_p_vals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
	                                    <span class="n">term_significance</span><span class="o">=</span><span class="n">LogOddsRatioUninformativeDirichletPrior</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span>
	                                    <span class="n">max_p_val</span><span class="o">=</span><span class="n">max_p_val</span><span class="p">,</span>
	                                    <span class="n">p_value_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
	                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="produce_frequency_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_frequency_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_frequency_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                               <span class="n">category</span><span class="p">,</span>
                               <span class="n">category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">not_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">term_ranker</span><span class="o">=</span><span class="n">termranking</span><span class="o">.</span><span class="n">AbsoluteFrequencyRanker</span><span class="p">,</span>
                               <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                               <span class="n">use_term_significance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">term_scorer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">not_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">grey_threshold</span><span class="o">=</span><span class="mf">1.96</span><span class="p">,</span>
                               <span class="n">y_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Produces a Monroe et al. style visualization, with the x-axis being the log frequency</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	corpus : Corpus</span>
<span class="sd">		Corpus to use.</span>
<span class="sd">	category : str</span>
<span class="sd">		Name of category column as it appears in original data frame.</span>
<span class="sd">	category_name : str or None</span>
<span class="sd">		Name of category to use.  E.g., &quot;5-star reviews.&quot;</span>
<span class="sd">		Defaults to category</span>
<span class="sd">	not_category_name : str or None</span>
<span class="sd">		Name of everything that isn&#39;t in category.  E.g., &quot;Below 5-star reviews&quot;.</span>
<span class="sd">		Defaults to &quot;Not &quot; + category_name</span>
<span class="sd">	term_ranker : TermRanker</span>
<span class="sd">		TermRanker class for determining term frequency ranks.</span>
<span class="sd">	alpha : float, default = 0.01</span>
<span class="sd">		Uniform dirichlet prior for p-value calculation</span>
<span class="sd">	use_term_significance : bool, True by default</span>
<span class="sd">		Use term scorer</span>
<span class="sd">	term_scorer : TermSignificance</span>
<span class="sd">		Subclass of TermSignificance to use as for scores and significance</span>
<span class="sd">	not_categories : list</span>
<span class="sd">		All categories other than category by default.  Documents labeled</span>
<span class="sd">		with remaining category.</span>
<span class="sd">	grey_threshold : float</span>
<span class="sd">		Score to grey points. Default is 1.96</span>
<span class="sd">	y_axis_values : list</span>
<span class="sd">		Custom y-axis values. Defaults to linspace</span>
<span class="sd">	Remaining arguments are from `produce_scattertext_explorer`.&#39;</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="k">if</span> <span class="n">not_categories</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">not_categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">get_categories</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">category</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">term_scorer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">term_scorer</span> <span class="o">=</span> <span class="n">LogOddsRatioUninformativeDirichletPrior</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

	<span class="n">term_freq_df</span> <span class="o">=</span> <span class="n">term_ranker</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">get_ranks</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
	<span class="n">freqs</span> <span class="o">=</span> <span class="n">term_freq_df</span><span class="p">[[</span><span class="n">c</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">+</span> <span class="n">not_categories</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
	<span class="n">x_axis_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">round_downer</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span>
	                 <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">freqs</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">5</span><span class="p">)]</span>
	<span class="n">x_axis_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_axis_values</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">freqs</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
	<span class="c1"># y_axis_values = [-2.58, -1.96, 0, 1.96, 2.58]</span>
	<span class="n">frequencies_log_scaled</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

	<span class="k">if</span> <span class="s1">&#39;scores&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
		<span class="n">zeta_i_j</span> <span class="o">=</span> <span class="n">term_scorer</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span>
			<span class="n">term_freq_df</span><span class="p">[</span><span class="n">category</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span><span class="p">],</span>
			<span class="n">term_freq_df</span><span class="p">[[</span><span class="n">c</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">not_categories</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="p">)</span>
		<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scores&#39;</span><span class="p">,</span> <span class="n">zeta_i_j</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">y_axis_rescale</span><span class="p">(</span><span class="n">coords</span><span class="p">):</span>
		<span class="k">return</span> <span class="p">((</span><span class="n">coords</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coords</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

	<span class="c1"># from https://stackoverflow.com/questions/3410976/how-to-round-a-number-to-significant-figures-in-python</span>
	<span class="k">def</span> <span class="nf">round_to_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span>
		<span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)))))</span>

	<span class="k">if</span> <span class="n">y_axis_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		y_axis_values = [round_to_1(x) for x</span>
<span class="sd">		                 in sorted(set(-np.linspace(0, np.max(np.abs(kwargs[&#39;scores&#39;])), 4))</span>
<span class="sd">		                           | set(np.linspace(0, np.max(np.abs(kwargs[&#39;scores&#39;])), 4))</span>
<span class="sd">		                           | {0})]</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">max_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
		<span class="n">min_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
		<span class="n">central</span> <span class="o">=</span> <span class="mf">0.5</span>
		<span class="k">if</span> <span class="n">min_score</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">central</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">central</span> <span class="o">=</span> <span class="mf">0.5</span>
		<span class="n">y_axis_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">min_score</span><span class="p">,</span> <span class="n">central</span><span class="p">,</span> <span class="n">max_score</span><span class="p">]</span>
		                 <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">min_score</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">max_score</span><span class="p">]</span>
	<span class="n">scores_scaled_for_charting</span> <span class="o">=</span> <span class="n">scale_neg_1_to_1_with_zero_mean_abs_max</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">])</span>
	<span class="c1"># kwargs[&#39;metadata&#39;] = kwargs.get(&#39;metadata&#39;, None),</span>
	<span class="k">if</span> <span class="n">use_term_significance</span><span class="p">:</span>
		<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;term_significance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">term_scorer</span>

	<span class="n">color_func</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;(function(d) {</span>
<span class="s1">	return (Math.abs(d.os) &lt; </span><span class="si">%s</span><span class="s1">) </span>
<span class="s1">	 ? d3.interpolate(d3.rgb(230, 230, 230), d3.rgb(130, 130, 130))(Math.abs(d.os)/</span><span class="si">%s</span><span class="s1">) </span>
<span class="s1">	 : d3.interpolateRdYlBu(d.y);</span>
<span class="s1">	})&#39;&#39;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">grey_threshold</span><span class="p">,</span> <span class="n">grey_threshold</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
	                                    <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
	                                    <span class="n">category_name</span><span class="o">=</span><span class="n">category_name</span><span class="p">,</span>
	                                    <span class="n">not_category_name</span><span class="o">=</span><span class="n">not_category_name</span><span class="p">,</span>
	                                    <span class="n">x_coords</span><span class="o">=</span><span class="n">frequencies_log_scaled</span><span class="p">,</span>
	                                    <span class="n">y_coords</span><span class="o">=</span><span class="n">scores_scaled_for_charting</span><span class="p">,</span>
	                                    <span class="n">original_x</span><span class="o">=</span><span class="n">freqs</span><span class="p">,</span>
	                                    <span class="n">original_y</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">],</span>
	                                    <span class="n">x_axis_values</span><span class="o">=</span><span class="n">x_axis_values</span><span class="p">,</span>
	                                    <span class="n">y_axis_values</span><span class="o">=</span><span class="n">y_axis_values</span><span class="p">,</span>
	                                    <span class="n">rescale_x</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
	                                    <span class="n">rescale_y</span><span class="o">=</span><span class="n">y_axis_rescale</span><span class="p">,</span>
	                                    <span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">term_ranker</span><span class="o">=</span><span class="n">term_ranker</span><span class="p">,</span>
	                                    <span class="n">color_func</span><span class="o">=</span><span class="n">color_func</span><span class="p">,</span>
	                                    <span class="n">not_categories</span><span class="o">=</span><span class="n">not_categories</span><span class="p">,</span>
	                                    <span class="n">x_label</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x_label&#39;</span><span class="p">,</span> <span class="s1">&#39;Log Frequency&#39;</span><span class="p">),</span>
	                                    <span class="n">y_label</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y_label&#39;</span><span class="p">,</span> <span class="n">term_scorer</span><span class="o">.</span><span class="n">get_name</span><span class="p">()),</span>
	                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<span class="c1"># for legacy reasons</span>
<span class="n">produce_fightin_words_explorer</span> <span class="o">=</span> <span class="n">produce_frequency_explorer</span>


<div class="viewcode-block" id="produce_semiotic_square_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_semiotic_square_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_semiotic_square_explorer</span><span class="p">(</span><span class="n">semiotic_square</span><span class="p">,</span>
                                     <span class="n">x_label</span><span class="p">,</span>
                                     <span class="n">y_label</span><span class="p">,</span>
                                     <span class="n">category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">not_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">neutral_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">get_tooltip_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">x_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">y_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">color_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">axis_scaler</span><span class="o">=</span><span class="n">scale_neg_1_to_1_with_zero_mean</span><span class="p">,</span>
                                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Produces a semiotic square visualization.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	semiotic_square : SemioticSquare</span>
<span class="sd">		The basis of the visualization</span>
<span class="sd">	x_label : str</span>
<span class="sd">		The x-axis label in the scatter plot.  Relationship between `category_a` and `category_b`.</span>
<span class="sd">	y_label</span>
<span class="sd">		The y-axis label in the scatter plot.  Relationship neutral term and complex term.</span>
<span class="sd">	category_name : str or None</span>
<span class="sd">		Name of category to use.  Defaults to category_a.</span>
<span class="sd">	not_category_name : str or None</span>
<span class="sd">		Name of everything that isn&#39;t in category.  Defaults to category_b.</span>
<span class="sd">	neutral_category_name : str or None</span>
<span class="sd">		Name of neutral set of data.  Defaults to &quot;Neutral&quot;.</span>
<span class="sd">	num_terms_semiotic_square : int or None</span>
<span class="sd">		10 by default. Number of terms to show in semiotic square.</span>
<span class="sd">	get_tooltip_content : str or None</span>
<span class="sd">		Defaults to tooltip showing z-scores on both axes.</span>
<span class="sd">	x_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on x-axis. [-2.58, -1.96, 0, 1.96, 2.58] is the default</span>
<span class="sd">	y_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on y-axis. [-2.58, -1.96, 0, 1.96, 2.58] is the default</span>
<span class="sd">	color_func : str, default None</span>
<span class="sd">		Javascript function to control color of a point.  Function takes a parameter</span>
<span class="sd">		which is a dictionary entry produced by `ScatterChartExplorer.to_dict` and</span>
<span class="sd">		returns a string. Defaults to RdYlBl on x-axis, and varying saturation on y-axis.</span>
<span class="sd">	axis_scaler : lambda, default scale_neg_1_to_1_with_zero_mean_abs_max</span>
<span class="sd">		Scale values to fit axis</span>
<span class="sd">	Remaining arguments are from `produce_scattertext_explorer`.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">if</span> <span class="n">category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">category_name</span> <span class="o">=</span> <span class="n">semiotic_square</span><span class="o">.</span><span class="n">category_a_</span>
	<span class="k">if</span> <span class="n">not_category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">not_category_name</span> <span class="o">=</span> <span class="n">semiotic_square</span><span class="o">.</span><span class="n">category_b_</span>

	<span class="k">if</span> <span class="n">get_tooltip_content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">get_tooltip_content</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;(function(d) {return d.term + &quot;&lt;br/&gt;</span><span class="si">%s</span><span class="s1">: &quot; + Math.round(d.ox*1000)/1000+&quot;&lt;br/&gt;</span><span class="si">%s</span><span class="s1">: &quot; + Math.round(d.oy*1000)/1000})&#39;&#39;&#39;</span> \
		                      <span class="o">%</span> <span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">color_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="c1"># this desaturates</span>
		<span class="c1"># color_func = &#39;(function(d) {var c = d3.hsl(d3.interpolateRdYlBu(d.x)); c.s *= d.y; return c;})&#39;</span>
		<span class="n">color_func</span> <span class="o">=</span> <span class="s1">&#39;(function(d) {return d3.interpolateRdYlBu(d.x)})&#39;</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	my_scaler = scale_neg_1_to_1_with_zero_mean_abs_max</span>
<span class="sd">	if foveate:</span>
<span class="sd">		my_scaler = scale_neg_1_to_1_with_zero_mean_rank_abs_max</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">axes</span> <span class="o">=</span> <span class="n">semiotic_square</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span><span class="n">semiotic_square</span><span class="o">.</span><span class="n">term_doc_matrix_</span><span class="p">,</span>
	                                    <span class="n">category</span><span class="o">=</span><span class="n">semiotic_square</span><span class="o">.</span><span class="n">category_a_</span><span class="p">,</span>
	                                    <span class="n">category_name</span><span class="o">=</span><span class="n">category_name</span><span class="p">,</span>
	                                    <span class="n">not_category_name</span><span class="o">=</span><span class="n">not_category_name</span><span class="p">,</span>
	                                    <span class="n">not_categories</span><span class="o">=</span><span class="p">[</span><span class="n">semiotic_square</span><span class="o">.</span><span class="n">category_b_</span><span class="p">],</span>
	                                    <span class="n">scores</span><span class="o">=-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
	                                    <span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">x_coords</span><span class="o">=</span><span class="n">axis_scaler</span><span class="p">(</span><span class="o">-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]),</span>
	                                    <span class="n">y_coords</span><span class="o">=</span><span class="n">axis_scaler</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span>
	                                    <span class="n">original_x</span><span class="o">=-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
	                                    <span class="n">original_y</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
	                                    <span class="n">show_characteristic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">show_top_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
	                                    <span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span>
	                                    <span class="n">semiotic_square</span><span class="o">=</span><span class="n">semiotic_square</span><span class="p">,</span>
	                                    <span class="n">neutral_categories</span><span class="o">=</span><span class="n">semiotic_square</span><span class="o">.</span><span class="n">neutral_categories_</span><span class="p">,</span>
	                                    <span class="n">show_neutral</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
	                                    <span class="n">neutral_category_name</span><span class="o">=</span><span class="n">neutral_category_name</span><span class="p">,</span>
	                                    <span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="n">num_terms_semiotic_square</span><span class="p">,</span>
	                                    <span class="n">get_tooltip_content</span><span class="o">=</span><span class="n">get_tooltip_content</span><span class="p">,</span>
	                                    <span class="n">x_axis_values</span><span class="o">=</span><span class="n">x_axis_values</span><span class="p">,</span>
	                                    <span class="n">y_axis_values</span><span class="o">=</span><span class="n">y_axis_values</span><span class="p">,</span>
	                                    <span class="n">color_func</span><span class="o">=</span><span class="n">color_func</span><span class="p">,</span>
	                                    <span class="n">show_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
	                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="produce_four_square_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_four_square_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_four_square_explorer</span><span class="p">(</span><span class="n">four_square</span><span class="p">,</span>
                                 <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">a_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">b_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">not_a_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">not_b_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">get_tooltip_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">x_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">y_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">color_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">axis_scaler</span><span class="o">=</span><span class="n">scale_neg_1_to_1_with_zero_mean</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Produces a semiotic square visualization.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	four_square : FourSquare</span>
<span class="sd">		The basis of the visualization</span>
<span class="sd">	x_label : str</span>
<span class="sd">		The x-axis label in the scatter plot.  Relationship between `category_a` and `category_b`.</span>
<span class="sd">	y_label</span>
<span class="sd">		The y-axis label in the scatter plot.  Relationship neutral term and complex term.</span>
<span class="sd">	a_category_name : str or None</span>
<span class="sd">		Name of category to use.  Defaults to category_a.</span>
<span class="sd">	b_category_name : str or None</span>
<span class="sd">		Name of everything that isn&#39;t in category.  Defaults to category_b.</span>
<span class="sd">	not_a_category_name : str or None</span>
<span class="sd">		Name of neutral set of data.  Defaults to &quot;Neutral&quot;.</span>
<span class="sd">	not_b_category_name: str or None</span>
<span class="sd">		Name of neutral set of data.  Defaults to &quot;Extra&quot;.</span>
<span class="sd">	num_terms_semiotic_square : int or None</span>
<span class="sd">		10 by default. Number of terms to show in semiotic square.</span>
<span class="sd">	get_tooltip_content : str or None</span>
<span class="sd">		Defaults to tooltip showing z-scores on both axes.</span>
<span class="sd">	x_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on x-axis. [-2.58, -1.96, 0, 1.96, 2.58] is the default</span>
<span class="sd">	y_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on y-axis. [-2.58, -1.96, 0, 1.96, 2.58] is the default</span>
<span class="sd">	color_func : str, default None</span>
<span class="sd">		Javascript function to control color of a point.  Function takes a parameter</span>
<span class="sd">		which is a dictionary entry produced by `ScatterChartExplorer.to_dict` and</span>
<span class="sd">		returns a string. Defaults to RdYlBl on x-axis, and varying saturation on y-axis.</span>
<span class="sd">	axis_scaler : lambda, default scale_neg_1_to_1_with_zero_mean_abs_max</span>
<span class="sd">		Scale values to fit axis</span>
<span class="sd">	Remaining arguments are from `produce_scattertext_explorer`.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">if</span> <span class="n">a_category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">a_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()[</span><span class="s1">&#39;a_label&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">a_category_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">a_category_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">a_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">category_a_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">b_category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">b_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()[</span><span class="s1">&#39;b_label&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">b_category_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">b_category_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">b_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">category_b_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">not_a_category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">not_a_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()[</span><span class="s1">&#39;not_a_label&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">not_a_category_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">not_a_category_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">not_a_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">not_category_a_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">not_b_category_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">not_b_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()[</span><span class="s1">&#39;not_b_label&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">not_b_category_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">not_b_category_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">not_b_category_name</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">not_category_b_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

	<span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">x_label</span> <span class="o">=</span> <span class="n">a_category_name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">b_category_name</span>
	<span class="k">if</span> <span class="n">y_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">y_label</span> <span class="o">=</span> <span class="n">not_a_category_name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">not_b_category_name</span>

	<span class="k">if</span> <span class="n">get_tooltip_content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">get_tooltip_content</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;(function(d) {return d.term + &quot;&lt;br/&gt;</span><span class="si">%s</span><span class="s1">: &quot; + Math.round(d.ox*1000)/1000+&quot;&lt;br/&gt;</span><span class="si">%s</span><span class="s1">: &quot; + Math.round(d.oy*1000)/1000})&#39;&#39;&#39;</span> \
		                      <span class="o">%</span> <span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">color_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="c1"># this desaturates</span>
		<span class="c1"># color_func = &#39;(function(d) {var c = d3.hsl(d3.interpolateRdYlBu(d.x)); c.s *= d.y; return c;})&#39;</span>
		<span class="n">color_func</span> <span class="o">=</span> <span class="s1">&#39;(function(d) {return d3.interpolateRdYlBu(d.x)})&#39;</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	my_scaler = scale_neg_1_to_1_with_zero_mean_abs_max</span>
<span class="sd">	if foveate:</span>
<span class="sd">		my_scaler = scale_neg_1_to_1_with_zero_mean_rank_abs_max</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">axes</span> <span class="o">=</span> <span class="n">four_square</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
	<span class="k">if</span> <span class="s1">&#39;scores&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
		<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>

	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span>
		<span class="n">four_square</span><span class="o">.</span><span class="n">term_doc_matrix_</span><span class="p">,</span>
		<span class="n">category</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">four_square</span><span class="o">.</span><span class="n">category_a_list_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">four_square</span><span class="o">.</span><span class="n">category_b_list_</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
		<span class="n">category_name</span><span class="o">=</span><span class="n">a_category_name</span><span class="p">,</span>
		<span class="n">not_category_name</span><span class="o">=</span><span class="n">b_category_name</span><span class="p">,</span>
		<span class="n">not_categories</span><span class="o">=</span><span class="n">four_square</span><span class="o">.</span><span class="n">category_b_list_</span><span class="p">,</span>
		<span class="n">neutral_categories</span><span class="o">=</span><span class="n">four_square</span><span class="o">.</span><span class="n">not_category_a_list_</span><span class="p">,</span>
		<span class="n">extra_categories</span><span class="o">=</span><span class="n">four_square</span><span class="o">.</span><span class="n">not_category_b_list_</span><span class="p">,</span>
		<span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">x_coords</span><span class="o">=</span><span class="n">axis_scaler</span><span class="p">(</span><span class="o">-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]),</span>
		<span class="n">y_coords</span><span class="o">=</span><span class="n">axis_scaler</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span>
		<span class="n">original_x</span><span class="o">=-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
		<span class="n">original_y</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
		<span class="n">show_characteristic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">show_top_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
		<span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span>
		<span class="n">semiotic_square</span><span class="o">=</span><span class="n">four_square</span><span class="p">,</span>
		<span class="n">show_neutral</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">neutral_category_name</span><span class="o">=</span><span class="n">not_a_category_name</span><span class="p">,</span>
		<span class="n">show_extra</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">extra_category_name</span><span class="o">=</span><span class="n">not_b_category_name</span><span class="p">,</span>
		<span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="n">num_terms_semiotic_square</span><span class="p">,</span>
		<span class="n">get_tooltip_content</span><span class="o">=</span><span class="n">get_tooltip_content</span><span class="p">,</span>
		<span class="n">x_axis_values</span><span class="o">=</span><span class="n">x_axis_values</span><span class="p">,</span>
		<span class="n">y_axis_values</span><span class="o">=</span><span class="n">y_axis_values</span><span class="p">,</span>
		<span class="n">color_func</span><span class="o">=</span><span class="n">color_func</span><span class="p">,</span>
		<span class="n">show_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="produce_four_square_axes_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_four_square_axes_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_four_square_axes_explorer</span><span class="p">(</span><span class="n">four_square_axes</span><span class="p">,</span>
                                      <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">get_tooltip_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">x_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">y_axis_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">color_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">axis_scaler</span><span class="o">=</span><span class="n">scale_neg_1_to_1_with_zero_mean</span><span class="p">,</span>
                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Produces a semiotic square visualization.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	four_square : FourSquareAxes</span>
<span class="sd">		The basis of the visualization</span>
<span class="sd">	x_label : str</span>
<span class="sd">		The x-axis label in the scatter plot.  Relationship between `category_a` and `category_b`.</span>
<span class="sd">	y_label</span>
<span class="sd">		The y-axis label in the scatter plot.  Relationship neutral term and complex term.</span>
<span class="sd">	not_b_category_name: str or None</span>
<span class="sd">		Name of neutral set of data.  Defaults to &quot;Extra&quot;.</span>
<span class="sd">	num_terms_semiotic_square : int or None</span>
<span class="sd">		10 by default. Number of terms to show in semiotic square.</span>
<span class="sd">	get_tooltip_content : str or None</span>
<span class="sd">		Defaults to tooltip showing z-scores on both axes.</span>
<span class="sd">	x_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on x-axis. [-2.58, -1.96, 0, 1.96, 2.58] is the default</span>
<span class="sd">	y_axis_values : list, default None</span>
<span class="sd">		Value-labels to show on y-axis. [-2.58, -1.96, 0, 1.96, 2.58] is the default</span>
<span class="sd">	color_func : str, default None</span>
<span class="sd">		Javascript function to control color of a point.  Function takes a parameter</span>
<span class="sd">		which is a dictionary entry produced by `ScatterChartExplorer.to_dict` and</span>
<span class="sd">		returns a string. Defaults to RdYlBl on x-axis, and varying saturation on y-axis.</span>
<span class="sd">	axis_scaler : lambda, default scale_neg_1_to_1_with_zero_mean_abs_max</span>
<span class="sd">		Scale values to fit axis</span>
<span class="sd">	Remaining arguments are from `produce_scattertext_explorer`.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">x_label</span> <span class="o">=</span> <span class="n">four_square_axes</span><span class="o">.</span><span class="n">left_category_name_</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">four_square_axes</span><span class="o">.</span><span class="n">right_category_name_</span>
	<span class="k">if</span> <span class="n">y_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">y_label</span> <span class="o">=</span> <span class="n">four_square_axes</span><span class="o">.</span><span class="n">top_category_name_</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">four_square_axes</span><span class="o">.</span><span class="n">bottom_category_name_</span>

	<span class="k">if</span> <span class="n">get_tooltip_content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">get_tooltip_content</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;(function(d) {return d.term + &quot;&lt;br/&gt;</span><span class="si">%s</span><span class="s1">: &quot; + Math.round(d.ox*1000)/1000+&quot;&lt;br/&gt;</span><span class="si">%s</span><span class="s1">: &quot; + Math.round(d.oy*1000)/1000})&#39;&#39;&#39;</span> \
		                      <span class="o">%</span> <span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">color_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="c1"># this desaturates</span>
		<span class="c1"># color_func = &#39;(function(d) {var c = d3.hsl(d3.interpolateRdYlBu(d.x)); c.s *= d.y; return c;})&#39;</span>
		<span class="n">color_func</span> <span class="o">=</span> <span class="s1">&#39;(function(d) {return d3.interpolateRdYlBu(d.x)})&#39;</span>
	<span class="n">axes</span> <span class="o">=</span> <span class="n">four_square_axes</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>

	<span class="k">if</span> <span class="s1">&#39;scores&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
		<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>

	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	my_scaler = scale_neg_1_to_1_with_zero_mean_abs_max</span>
<span class="sd">	if foveate:</span>
<span class="sd">		my_scaler = scale_neg_1_to_1_with_zero_mean_rank_abs_max</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span>
		<span class="n">four_square_axes</span><span class="o">.</span><span class="n">term_doc_matrix_</span><span class="p">,</span>
		<span class="n">category</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">left_categories_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
		<span class="n">category_name</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">left_category_name_</span><span class="p">,</span>
		<span class="n">not_categories</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">right_categories_</span><span class="p">,</span>
		<span class="n">not_category_name</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">right_category_name_</span><span class="p">,</span>
		<span class="n">neutral_categories</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">top_categories_</span><span class="p">,</span>
		<span class="n">neutral_category_name</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">top_category_name_</span><span class="p">,</span>
		<span class="n">extra_categories</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">bottom_categories_</span><span class="p">,</span>
		<span class="n">extra_category_name</span><span class="o">=</span><span class="n">four_square_axes</span><span class="o">.</span><span class="n">bottom_category_name_</span><span class="p">,</span>
		<span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">x_coords</span><span class="o">=</span><span class="n">axis_scaler</span><span class="p">(</span><span class="o">-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]),</span>
		<span class="n">y_coords</span><span class="o">=</span><span class="n">axis_scaler</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span>
		<span class="n">original_x</span><span class="o">=-</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
		<span class="n">original_y</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
		<span class="n">show_characteristic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">show_top_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
		<span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span>
		<span class="n">semiotic_square</span><span class="o">=</span><span class="n">four_square_axes</span><span class="p">,</span>
		<span class="n">show_neutral</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">show_extra</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">num_terms_semiotic_square</span><span class="o">=</span><span class="n">num_terms_semiotic_square</span><span class="p">,</span>
		<span class="n">get_tooltip_content</span><span class="o">=</span><span class="n">get_tooltip_content</span><span class="p">,</span>
		<span class="n">x_axis_values</span><span class="o">=</span><span class="n">x_axis_values</span><span class="p">,</span>
		<span class="n">y_axis_values</span><span class="o">=</span><span class="n">y_axis_values</span><span class="p">,</span>
		<span class="n">color_func</span><span class="o">=</span><span class="n">color_func</span><span class="p">,</span>
		<span class="n">show_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="o">**</span><span class="n">kwargs</span>
	<span class="p">)</span></div>


<div class="viewcode-block" id="produce_projection_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_projection_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_projection_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                                <span class="n">category</span><span class="p">,</span>
                                <span class="n">word2vec_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">projection_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">embeddings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">term_acceptance_re</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[a-z]{3,}&#39;</span><span class="p">),</span>
                                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	corpus : Corpus</span>
<span class="sd">		It is highly recommended to use a stoplisted, unigram corpus-- `corpus.get_stoplisted_unigram_corpus()`</span>
<span class="sd">	category : str</span>
<span class="sd">	word2vec_model : Word2Vec</span>
<span class="sd">		A gensim word2vec model.  A default model will be used instead.</span>
<span class="sd">	projection_model : sklearn-style dimensionality reduction model.</span>
<span class="sd">		By default: umap.UMAP(min_dist=0.5, metric=&#39;cosine&#39;)</span>
<span class="sd">	  You could also use, e.g., sklearn.manifold.TSNE(perplexity=10, n_components=2, init=&#39;pca&#39;, n_iter=2500, random_state=23)</span>
<span class="sd">	embeddings : array[len(corpus.get_terms()), X]</span>
<span class="sd">		Word embeddings.  If None (default), wil train them using word2vec Model</span>
<span class="sd">	term_acceptance_re : SRE_Pattern</span>
<span class="sd">		Regular expression to identify valid terms</span>
<span class="sd">	kwargs : dict</span>
<span class="sd">		remaining produce_scattertext_explorer keywords</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	str</span>
<span class="sd">	HTML of visualization</span>

<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">if</span> <span class="n">word2vec_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span> <span class="nn">gensim.models</span> <span class="k">import</span> <span class="n">word2vec</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Please install gensim before using the default model&quot;</span><span class="p">)</span>
	<span class="c1"># word2vec_model = word2vec.Word2Vec(size=100, window=5, min_count=10, workers=4)</span>
	<span class="k">if</span> <span class="n">projection_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">import</span> <span class="nn">umap</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Please install umap (pip install umap-learn) to use the default projection_model.&quot;</span><span class="p">)</span>
		<span class="n">projection_model</span> <span class="o">=</span> <span class="n">umap</span><span class="o">.</span><span class="n">UMAP</span><span class="p">(</span><span class="n">min_dist</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">embeddings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">acceptable_terms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">()</span> <span class="k">if</span> <span class="n">term_acceptance_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
		<span class="n">corpus</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">remove_terms</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">())</span> <span class="o">-</span> <span class="n">acceptable_terms</span><span class="p">)</span>
		<span class="n">model</span> <span class="o">=</span> <span class="n">Word2VecFromParsedCorpus</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="n">word2vec_model</span><span class="p">)</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
		<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vocab</span><span class="p">]</span>
		<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">weights</span> <span class="o">=</span> <span class="n">embeddings</span>
	<span class="n">axes</span> <span class="o">=</span> <span class="n">projection_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
	<span class="n">word_axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;term&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vocab</span><span class="p">],</span>
	                           <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
	                           <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
	             <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;term&#39;</span><span class="p">)</span>
	             <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">()))</span>
	             <span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
	<span class="n">corpus</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">remove_terms</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">word_axes</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
	<span class="n">word_axes</span> <span class="o">=</span> <span class="n">word_axes</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">())</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
	<span class="n">html</span> <span class="o">=</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span>
		<span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span>
		<span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
		<span class="n">minimum_term_frequency</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
		<span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">x_coords</span><span class="o">=</span><span class="n">scale</span><span class="p">(</span><span class="n">word_axes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]),</span>
		<span class="n">y_coords</span><span class="o">=</span><span class="n">scale</span><span class="p">(</span><span class="n">word_axes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span>
		<span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
		<span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
		<span class="o">**</span><span class="n">kwargs</span>
	<span class="p">)</span>
	<span class="k">return</span> <span class="n">html</span></div>


<div class="viewcode-block" id="produce_characteristic_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.produce_characteristic_explorer">[docs]</a><span class="k">def</span> <span class="nf">produce_characteristic_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                                    <span class="n">category</span><span class="p">,</span>
                                    <span class="n">category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">not_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">not_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">characteristic_scorer</span><span class="o">=</span><span class="n">DenseRankCharacteristicness</span><span class="p">(),</span>
                                    <span class="n">term_ranker</span><span class="o">=</span><span class="n">termranking</span><span class="o">.</span><span class="n">AbsoluteFrequencyRanker</span><span class="p">,</span>
                                    <span class="n">term_scorer</span><span class="o">=</span><span class="n">RankDifference</span><span class="p">(),</span>
                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	corpus : Corpus</span>
<span class="sd">		It is highly recommended to use a stoplisted, unigram corpus-- `corpus.get_stoplisted_unigram_corpus()`</span>
<span class="sd">	category : str</span>
<span class="sd">	category_name : str</span>
<span class="sd">	not_category_name : str</span>
<span class="sd">	not_categories : list</span>
<span class="sd">	characteristic_scorer : CharacteristicScorer</span>
<span class="sd">	term_ranker</span>
<span class="sd">	term_scorer</span>
<span class="sd">	term_acceptance_re : SRE_Pattern</span>
<span class="sd">		Regular expression to identify valid terms</span>
<span class="sd">	kwargs : dict</span>
<span class="sd">		remaining produce_scattertext_explorer keywords</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	str HTML of visualization</span>

<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">if</span> <span class="n">not_categories</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">not_categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corpus</span><span class="o">.</span><span class="n">get_categories</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">category</span><span class="p">]</span>


	<span class="n">category_name</span><span class="p">,</span> <span class="n">not_category_name</span> <span class="o">=</span> <span class="n">get_category_names</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="n">not_categories</span><span class="p">,</span> <span class="n">not_category_name</span><span class="p">)</span>

	<span class="n">zero_point</span><span class="p">,</span> <span class="n">characteristic_scores</span> <span class="o">=</span> <span class="n">characteristic_scorer</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
	<span class="n">corpus</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">remove_terms</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">characteristic_scores</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
	<span class="n">characteristic_scores</span> <span class="o">=</span> <span class="n">characteristic_scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_terms</span><span class="p">()]</span>
	<span class="n">term_freq_df</span> <span class="o">=</span> <span class="n">term_ranker</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">get_ranks</span><span class="p">()</span>
	<span class="n">scores</span> <span class="o">=</span> <span class="n">term_scorer</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span>
		<span class="n">term_freq_df</span><span class="p">[</span><span class="n">category</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span><span class="p">],</span>
		<span class="n">term_freq_df</span><span class="p">[[</span><span class="n">c</span> <span class="o">+</span> <span class="s1">&#39; freq&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">not_categories</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">)</span>
	<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scores&#39;</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
	<span class="n">max_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
	<span class="n">min_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
	<span class="k">if</span> <span class="n">min_score</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">central</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">central</span> <span class="o">=</span> <span class="mf">0.5</span>
	<span class="n">scores_scaled_for_charting</span> <span class="o">=</span> <span class="n">scale_neg_1_to_1_with_zero_mean_abs_max</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scores&#39;</span><span class="p">])</span>
	<span class="n">html</span> <span class="o">=</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span>
		<span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span>
		<span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
		<span class="n">category_name</span><span class="o">=</span><span class="n">category_name</span><span class="p">,</span>
		<span class="n">not_category_name</span><span class="o">=</span><span class="n">not_category_name</span><span class="p">,</span>
		<span class="n">not_categories</span><span class="o">=</span><span class="n">not_categories</span><span class="p">,</span>
		<span class="n">minimum_term_frequency</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
		<span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">x_coords</span><span class="o">=</span><span class="n">characteristic_scores</span><span class="p">,</span>
		<span class="n">y_coords</span><span class="o">=</span><span class="n">scores_scaled_for_charting</span><span class="p">,</span>
		<span class="n">y_axis_labels</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y_axis_labels&#39;</span><span class="p">,</span>
		                         <span class="p">[</span><span class="s1">&#39;More &#39;</span> <span class="o">+</span> <span class="n">not_category_name</span><span class="p">,</span>
		                          <span class="s1">&#39;Even&#39;</span><span class="p">,</span>
		                          <span class="s1">&#39;More &#39;</span> <span class="o">+</span> <span class="n">category_name</span><span class="p">]),</span>
		<span class="n">x_label</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x_label&#39;</span><span class="p">,</span> <span class="s1">&#39;Characteristic to Corpus&#39;</span><span class="p">),</span>
		<span class="n">y_label</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y_label&#39;</span><span class="p">,</span> <span class="n">term_scorer</span><span class="o">.</span><span class="n">get_name</span><span class="p">()),</span>
		<span class="n">vertical_lines</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vertical_lines&#39;</span><span class="p">,</span> <span class="p">[]),</span>
		<span class="n">characteristic_scorer</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;characteristic_scorer&#39;</span><span class="p">,</span> <span class="n">characteristic_scorer</span><span class="p">),</span>
		<span class="o">**</span><span class="n">kwargs</span>
	<span class="p">)</span>
	<span class="k">return</span> <span class="n">html</span></div>


<div class="viewcode-block" id="sparse_explorer"><a class="viewcode-back" href="../scattertext.html#scattertext.sparse_explorer">[docs]</a><span class="k">def</span> <span class="nf">sparse_explorer</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                    <span class="n">category</span><span class="p">,</span>
                    <span class="n">scores</span><span class="p">,</span>
                    <span class="n">category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">not_category_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	corpus : Corpus</span>
<span class="sd">		Corpus to use.</span>
<span class="sd">	category : str</span>
<span class="sd">		Name of category column as it appears in original data frame.</span>
<span class="sd">	category_name : str</span>
<span class="sd">		Name of category to use.  E.g., &quot;5-star reviews.&quot;</span>
<span class="sd">	not_category_name : str</span>
<span class="sd">		Name of everything that isn&#39;t in category.  E.g., &quot;Below 5-star reviews&quot;.</span>
<span class="sd">	scores : np.array</span>
<span class="sd">		Scores to display in visualization.  Zero scores are grey.</span>

<span class="sd">	Remaining arguments are from `produce_scattertext_explorer`.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">		str, html of visualization</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="k">return</span> <span class="n">produce_scattertext_explorer</span><span class="p">(</span>
		<span class="n">corpus</span><span class="p">,</span>
		<span class="n">category</span><span class="p">,</span>
		<span class="n">category_name</span><span class="p">,</span>
		<span class="n">not_category_name</span><span class="p">,</span>
		<span class="n">scores</span><span class="o">=</span><span class="n">scores</span><span class="p">,</span>
		<span class="n">sort_by_dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">gray_zero_scores</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="o">**</span><span class="n">kwargs</span>
	<span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jason S. Kessler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>